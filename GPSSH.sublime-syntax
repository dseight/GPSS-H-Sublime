%YAML 1.2
# Sublime syntax for GPSS/H v.2.0
---
name: GPSS/H
file_extensions: [gps]
scope: source.gps

contexts:
  main:
    - match: '^\*.*'
      scope: comment.line.character.gps
    - match: '^[^A-Z0-9 \t\n].*'
      scope: invalid.illegal.gps
    - match: '^ [^ ].*'
      scope: invalid.illegal.gps
    - match: '^  +[^A-Z \t].*'
      scope: invalid.illegal.gps
    - match: '^[A-Z0-9]'
      scope: entity.name.tag.gps
      set: label
    - match: '  +'
      set: block

  label:
    - match: '$'
      set: main
    - match: '[A-Z0-9]*'
      scope: entity.name.tag.gps
    - match: ' '
      set: block
  
  block:
    - match: '$'
      set: main
    - match: '[^A-Z \t].*'
      scope: invalid.illegal.gps
    - match: '(TEST|LOGIC|GATE|CHAR|VCHAR) *'
      scope: support.function.gps
      set: extarg
    - match: '[A-Z]+ *'
      scope: support.function.gps
      set: args

  # Second argument (which comes first)
  extarg:
    - match: '$'
      set: main
    - match: '[^ _\*]*'
      scope: variable.parameter.gps
    - match: ' '
      set: args

  args:
    - match: '$'
      set: main
    - match: '[^ _\*]*'
      scope: variable.parameter.gps
    - match: ' '
      set: comment

  comment:
    - match: '.*$'
      scope: comment.block.documentation.gps
      set: main
...
